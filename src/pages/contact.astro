---
import Layout from '../layouts/Layout.astro';

export const prerender = false;

const sentStatus = Astro.url.searchParams.get('sent');
const sentSuccessfully = sentStatus === '1';
const sentFailed = sentStatus === '0';
const contactDisabled = import.meta.env.PUBLIC_CONTACT_DISABLED === 'true';
---
<Layout title="Contato - Vanderlei" description="Fale comigo.">
  <section class="surface p-5">
    <h1 class="text-2xl md:text-3xl font-semibold">Contato</h1>
    {sentSuccessfully && (
      <p class="mt-4 rounded-lg border border-emerald-500/40 bg-emerald-500/10 px-3 py-2 text-sm text-emerald-100">
        Obrigado! Sua mensagem foi enviada.
      </p>
    )}
    {sentFailed && (
      <p class="mt-4 rounded-lg border border-red-500/40 bg-red-500/10 px-3 py-2 text-sm text-red-100">
        Nao foi possivel enviar sua mensagem. Tente novamente em instantes.
      </p>
    )}
    {contactDisabled && (
      <p class="mt-4 rounded-lg border border-amber-500/40 bg-amber-500/5 px-3 py-2 text-sm text-amber-200">
        O envio de mensagens esta temporariamente desativado. Volte mais tarde ou use outro meio de contato.
      </p>
    )}
    <form action={contactDisabled ? undefined : '/api/contact'} method="POST" class="mt-6 max-w-lg space-y-3">
      <input name="name" placeholder="Nome" class="w-full rounded-xl border border-white/15 bg-transparent p-2" required />
      <input name="email" type="email" placeholder="Email" class="w-full rounded-xl border border-white/15 bg-transparent p-2" required />
      <textarea name="message" placeholder="Mensagem" class="w-full rounded-xl border border-white/15 bg-transparent p-2" rows="5" required></textarea>
      <button
        class="inline-flex rounded-xl px-4 py-2 text-sm font-medium bg-white text-black hover:opacity-90 hover-glow disabled:cursor-not-allowed disabled:opacity-50"
        disabled={contactDisabled}
        aria-disabled={contactDisabled}
      >
        Enviar
      </button>
    </form>
  </section>
</Layout>
